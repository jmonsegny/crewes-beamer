% University of Calgary CREWES Beamer package.
%
% Copyright (C) 2020 University of Calgary (Jorge Monsegny)
%
% This program is free software; you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation; either version 2 of the License, or
% (at your option) any later version.
%
% This program is distributed in the hope that it will be useful,
% but WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
% GNU General Public License for more details.
%
% You should have received a copy of the GNU General Public License
% along with this program; if not, write to the Free Software
% 

\mode<presentation>

% Options
\DeclareOptionBeamer{cmc}{\def\beamer@crewes@cmc{#1}}
\DeclareOptionBeamer{miniframes}{\def\beamer@crewes@miniframes{#1}}
\ProcessOptionsBeamer

% Slides backgrounds
\setbeamertemplate{background}{
  \ifnum\thepage>1\relax% For slides 2,3,... and so on
   \ifx\beamer@crewes@miniframes\@empty% Insert navigation above title
        \begin{tikzpicture}
        \useasboundingbox (0,0) rectangle (\the\paperwidth,\the\paperheight);
        \node[anchor=west] (creweslogo2) at (0.00,8.18)% Crewes logo with no text at the corner
        {\includegraphics[scale=0.85]{crewesimg/CREWESlogoBlue2.pdf}};    
        \fill[color=crewesblue] (0,7.68) rectangle (\the\paperwidth,7.78); % Blue line under title space
        \end{tikzpicture} 
   \else%
    \begin{tikzpicture}
        \useasboundingbox (0,0) rectangle (\the\paperwidth,\the\paperheight);
        \node[anchor=west] (creweslogo2) at (0.00,8.63)% Crewes logo with no text at the corner
        {\includegraphics[scale=0.85]{crewesimg/CREWESlogoBlue2.pdf}};    
        \fill[color=crewesblue] (0,8.18) rectangle (\the\paperwidth,8.28); % Blue line under title space
    \end{tikzpicture}   
   \fi%
  \else% For slide 1 or title slide
    \ifx\beamer@crewes@cmc\@empty%
        \def\cmc{cmc}%
    \else%
        \def\cmc{}%
    \fi%
    \begin{tikzpicture}
        \useasboundingbox (0,0) rectangle (\the\paperwidth,\the\paperheight);
        \node[anchor=west] at (0.00,8.63)% Crewes logo with text at corner
        {\includegraphics[scale=0.85]{crewesimg/CREWESlogoBlue.pdf}};
        \node[anchor=east] at (26.5,8.55)% Crewes url at corner
        {\begin{beamercolorbox}{url}
        \usebeamerfont{url}www.crewes.org%
        \end{beamercolorbox}};
        \fill[color=crewesblue] (0.0,8.18) rectangle (\the\paperwidth,8.28); % Blue line    
        \node (creweslogo) at (3.5,0.4)% Additional logos at the bottom
        {\includegraphics[scale=0.17]{crewesimg/sublogos\cmc.pdf}};
    \end{tikzpicture}   
  \fi%
}

% Title page
\defbeamertemplate*{title page}{crewes}[1][]
{ 
   \vskip0.5cm%
    \begin{beamercolorbox}[wd=\textwidth,leftskip=0.1cm,#1]{title}%{title page header}
      \usebeamerfont{title}\inserttitle\par%
    \end{beamercolorbox}
    \vskip0.5cm%
    \begin{beamercolorbox}[wd=\textwidth,leftskip=0.1cm,#1]{author}
      \usebeamerfont{author}\insertauthor%
    \end{beamercolorbox}
     \vskip0.75cm%
    \begin{beamercolorbox}[wd=\textwidth,leftskip=0.1cm,#1]{date}
      \usebeamerfont{date}\insertdate%
    \end{beamercolorbox}
  \vfill
}

\mode<all>
